{"version":3,"file":"index.es.js","sources":["../src/localStorageSafe.js"],"sourcesContent":["const initTypeData = (data, type) => {\n  switch (type) {\n    case 'array':\n      if (!Array.isArray(data)) {\n        return [];\n      } else {\n        return data;\n      }\n\n    case 'object':\n      if (typeof data !== 'object' || Array.isArray(data) || data === null) {\n        return {};\n      } else {\n        return data;\n      }\n\n    case 'string':\n      if (typeof data !== 'string') {\n        return '';\n      } else {\n        return data;\n      }\n    case 'number':\n      try {\n        const numberData = JSON.parse(data);\n        if (numberData !== 'number') {\n          return 0;\n        } else {\n          return numberData;\n        }\n      } catch (err) {\n        return 0;\n      }\n    default:\n      if (data) {\n        return null;\n      } else {\n        return data;\n      }\n  }\n};\n\nconst localStorageSafe = {\n  getItem: (key, type) => {\n    try {\n      const item = JSON.parse(localStorage.getItem(key));\n      if (item.expiresTime) {\n        return new Date().getTime() > item.expiresTime\n          ? initTypeData(null, type)\n          : initTypeData(item.data, type);\n      } else {\n        return initTypeData(item, type);\n      }\n    } catch (err) {\n      return localStorage.getItem(key)\n        ? initTypeData(localStorage.getItem(key), type)\n        : initTypeData(null, type);\n    }\n  },\n  setItem: (key, data, expires) => {\n    if (expires) {\n      localStorage.setItem(\n        key,\n        JSON.stringify({data, expiresTime: new Date().getTime() + expires}),\n      );\n    } else {\n      localStorage.setItem(\n        key,\n        typeof data === 'object' ? JSON.stringify(data) : data,\n      );\n    }\n  },\n};\n\ntry {\n  if (window) {\n    window.localStorageSafe = localStorageSafe;\n  }\n} catch (err) {\n  console.log(err);\n}\n\nexport default localStorageSafe;\n"],"names":[],"mappings":"AAAA,MAAM,YAAY,GAAG,CAAC,IAAI,EAAE,IAAI,KAAK;EACnC,QAAQ,IAAI;IACV,KAAK,OAAO;MACV,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;QACxB,OAAO,EAAE,CAAC;OACX,MAAM;QACL,OAAO,IAAI,CAAC;OACb;;IAEH,KAAK,QAAQ;MACX,IAAI,OAAO,IAAI,KAAK,QAAQ,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,IAAI,KAAK,IAAI,EAAE;QACpE,OAAO,EAAE,CAAC;OACX,MAAM;QACL,OAAO,IAAI,CAAC;OACb;;IAEH,KAAK,QAAQ;MACX,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;QAC5B,OAAO,EAAE,CAAC;OACX,MAAM;QACL,OAAO,IAAI,CAAC;OACb;IACH,KAAK,QAAQ;MACX,IAAI;QACF,MAAM,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QACpC,IAAI,UAAU,KAAK,QAAQ,EAAE;UAC3B,OAAO,CAAC,CAAC;SACV,MAAM;UACL,OAAO,UAAU,CAAC;SACnB;OACF,CAAC,OAAO,GAAG,EAAE;QACZ,OAAO,CAAC,CAAC;OACV;IACH;MACE,IAAI,IAAI,EAAE;QACR,OAAO,IAAI,CAAC;OACb,MAAM;QACL,OAAO,IAAI,CAAC;OACb;GACJ;CACF,CAAC;;AAEF,MAAM,gBAAgB,GAAG;EACvB,OAAO,EAAE,CAAC,GAAG,EAAE,IAAI,KAAK;IACtB,IAAI;MACF,MAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC;MACnD,IAAI,IAAI,CAAC,WAAW,EAAE;QACpB,OAAO,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,WAAW;YAC1C,YAAY,CAAC,IAAI,EAAE,IAAI,CAAC;YACxB,YAAY,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;OACnC,MAAM;QACL,OAAO,YAAY,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;OACjC;KACF,CAAC,OAAO,GAAG,EAAE;MACZ,OAAO,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC;UAC5B,YAAY,CAAC,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,IAAI,CAAC;UAC7C,YAAY,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;KAC9B;GACF;EACD,OAAO,EAAE,CAAC,GAAG,EAAE,IAAI,EAAE,OAAO,KAAK;IAC/B,IAAI,OAAO,EAAE;MACX,YAAY,CAAC,OAAO;QAClB,GAAG;QACH,IAAI,CAAC,SAAS,CAAC,CAAC,IAAI,EAAE,WAAW,EAAE,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,GAAG,OAAO,CAAC,CAAC;OACpE,CAAC;KACH,MAAM;MACL,YAAY,CAAC,OAAO;QAClB,GAAG;QACH,OAAO,IAAI,KAAK,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,IAAI;OACvD,CAAC;KACH;GACF;CACF,CAAC;;AAEF,IAAI;EACF,IAAI,MAAM,EAAE;IACV,MAAM,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;GAC5C;CACF,CAAC,OAAO,GAAG,EAAE;EACZ,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;CAClB;;;;"}